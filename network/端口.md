# 端口



## 多个客户端同时连接到一个端口

Q: 我了解端口如何工作的基础知识。然而，我不知道的是多个客户机如何同时连接到端口80，我知道每个客户都有一个唯一的(为他们的机器)端口，服务器是否从可用端口响应客户端，并简单地说明回复来自80？这是如何运作的？

A: 首先，一个"端口"只是一个数字。所有的"连接到端口"实际上都表示一个包，该数据包在它"目标端口"字段中指定。

现在，你的问题有两个答案，一个用于状态协议，一个用于无状态协议。

无状态协议(=udp )没有问题，因为"连接"不存在-多个人可以向同一端口发送数据包，没有人在"连接"状态。

对于有状态协议（如TCP），连接由4元组标识，包括源和目标端口以及源和目标IP地址。因此，如果两台不同的机器连接到第三台机器上的同一端口，则有两个不同的连接，因为源IP不同。如果同一台机器（或两台NAT后面或共享相同的IP地址）连接两次到一个远端，则连接由源端口（通常是随机的高编号端口）区分。

简单地说，如果我从我的客户端连接到同一个Web服务器两次，这两个连接将具有来自我的角度的不同源端口和来自Web服务器的目标端口。因此，即使两个连接都有相同的源和目标IP地址，也没有歧义。

端口是一种多路复用IP地址以便不同的应用程序可以监听同一个IP地址/协议对的方法，除非应用程序定义了自己的高级协议，否则无法对端口进行多路复用，如果使用相同协议的两个连接具有相同的源和目标IP以及相同的源和目标端口，则它们必须是相同的连接。

通常，服务器将服务器绑定到与客户端(TCP )通信的每个连接客户端，父服务器向子进程移交一个已建立与客户端通信的已建立套接字。

当你将数据从子服务器发送到一个套接字时，操作系统中的TCP栈将创建一个数据包，并且将它设置为80。



## 引用/参考

[在服务器以上，多个客户端同时连接到一个端口，比如说80，怎么做 ？ - 酷徒编程知识库](https://kb.kutu66.com/others/post_229686)