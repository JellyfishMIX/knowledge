# Redis数据结构



## 五种基本数据结构

1. String，redis 中的 String 类型和其他很多编程语言中的语义类似，value 可以是 String 也可以是数字。 一般做一些复杂的计数功能的缓存，比如说微博数，粉丝数等。
2. Hash，也可以称为 hashes， 是一个 string 类型的 key 和 value 的映射表，特别适合用于存储对象，。比如我们可以 hash 数据结构来存储用户信息，商品信息等等。内部可以用 hashtable 和 ziplist 两种承载方式来实现。
3. List，list 是 redis 最重要的数据结构之一，可以做简单的消息队列的功能，比如论坛点赞人列表、微博粉丝列表等；另外还可以利用 lrange 命令，可以从某个元素开始读取多少个元素，实现简单的高性能分页，类似微博那种下拉不断分页的东西，性能极佳，用户体验好。
4. Set，set 类似 List，但是它是一个无序集合，且其中的元素不重复。可以做全局去重的功能，比如说是否给帖子点赞数；也可以判断某个元素是否在 set，比如说判断是否给某个回复点赞。另外还可以利用交集、并集、差集等操作来支撑更多的业务场景，比如说找出两个微博 ID 的共同好友等。
5. Sorted Set，sorted set 相比 set 增加了一个权重参数 score，使得集合中的元素能够按 score 进行有序排列，比如说可以用于取排行榜 top N 的用户。



## HASH

### 命令参数
- ```
  HSET key field value
  ```

- ```
  HSETNX key field value
  ```

### 作用区别
- HSET 将哈希表 key 中的域 field 的值设为 value 。如果 key 不存在，一个新的哈希表被创建并进行 HSET 操作。如果域 field 已经存在于哈希表中，旧值将被覆盖。

- HSETNX 将哈希表 key 中的域 field 的值设置为 value ，当且仅当域 field 不存在。若域 field 已经存在，该操作无效。

- 如果 key 不存在，一个新哈希表被创建并执行 HSETNX 命令。

### 返回值区别
- HSET：如果 field 是哈希表中的一个新建域，并且值设置成功，返回 1 。如果哈希表中域 field 已经存在且旧值已被新值覆盖，返回 0 。
- HSETNX：设置成功，返回 1 。如果给定域已经存在且没有操作被执行，返回 0 。

