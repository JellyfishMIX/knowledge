# 线段树



##适用问题

### 区间染色

![截屏2020-09-25上午9.24.14](https://image-hosting.jellyfishmix.com/20200925092449.png)

m次操作后，我们可以在[i, j]区间内看见多少种颜色？

m次操作后，我们可以看见多少种颜色？（可以理解为区间[0, n-1]）。

|                      | 使用数组实现 |
| -------------------- | ------------ |
| 染色操作（更新区间） | O(n)         |
| 查询操作（查询区间） | O(n)         |

### 基于区间的统计查询

2017年至今注册用户中消费最高的用户？消费最少的用户？学习时间最长的用户？

某个太空区间中天体的总量？

|      | 使用数组实现 | 使用线段树 |
| ---- | ------------ | ---------- |
| 更新 | O(n)         | O(logn)    |
| 查询 | O(n)         | O(logn)    |

### 普遍适用的问题

![截屏2020-09-25上午9.32.43](https://image-hosting.jellyfishmix.com/20200925093251.png)

对于给定区间

更新： 更新区间中一个元素或一个区间的值。

查询：查询一个区间[i, j]的最大值，最小值，或者区间数字和。



## 结构

![截屏2020-09-25上午9.39.07](https://image-hosting.jellyfishmix.com/20200925093958.png)

线段树并不一定是满二叉树，例如：

![截屏2020-09-25上午9.45.17](https://image-hosting.jellyfishmix.com/20200925094652.png)