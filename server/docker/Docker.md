# Docker



## 简介

可以粗糙地理解为轻量级的虚拟机。但它不是虚拟机。

![截屏2020-06-21下午4.44.58](https://image-hosting.jellyfishmix.com/20200621164704.png)

- 虚拟机（VM）
  - Hypervisor虚拟出了硬件层。
- Docker
  - 没有虚拟硬件层。
  - 使用Host OS中的namespace, control group等做到将application分离。因此Docker是轻量级的，程序启动速度提升，内存占用减小。



## Docker思想

- 集装箱
  - 我们在不同机器上搬运程序的时候，有可能少发送了配置文件等，导致不能运行，程序散乱。按照标准放进集装箱，帮助标准化装配。

- 标准化

  - 运输方式

    把货物（程序）放进集装箱，把鲸鱼叫过来，让它把集装箱运到超级码头。使用的时候让鲸鱼把集装箱从超级码头搬运过来。

  - 存储方式

    程序copy到另一台机器的时候，需要指定一个目录，在去此目录中寻找。有了docker，可以不用关心应用存在何处，运行/停止时，只需要使用docker命令就好。

  - API接口

    docker提供了一系列控制API，包括启动停止等。如果用tomcat、nginx等服务器，启动停止等命令不同。接口标准化后，使用API即可控制所有命令。

- 隔离

  - 使用linux的内核限制技术（lxc），隔离进程和资源。轻量级的容器虚拟化技术，最大效率地隔离了进程和资源。比虚拟机更轻量。



## Docker的出现解决了什么问题

- 解决了系统环境不一致所带来的问题

  开发to运维：我本地运行没问题啊！怎么在你的服务器上跑不起来呢。（开始踢皮球）

  程序启动起来需要什么：操作系统，jdk，web server，代码，配置文件...

  docker来了，docker把操作系统，jdk，web server，代码，配置文件装进了集装箱。docker解决了系统环境不一致所带来的问题。

- 程序之间的隔离

  系统好卡，内存不够了，硬盘满了，服务变慢了，甚至敲终端都卡。

  使用docker解决这个问题。

  docker的隔离性解决了这个问题。

  如果一个程序发生了错误，异常吃性能吃资源，都不会导致其它程序发生错误。因为docker在程序启动的时候就为其设置了可使用的资源量，超过即杀掉。

- 机器临时扩展

  节日（类似于双11）时，负载迅速上涨，需要临时扩展机器，过完节日再把机器下线。

  这种临时扩展的需求，对于运维来说工作量很大，需要一台台机器去配环境。

  有了docker，只需要用鼠标点一点，即可从1台扩展到100台。因为有了docker标准化，在每台机器上使用标准的命令，即可将集装箱在docker中运行。



## 特点

- docker解决了软件包装的问题，缓和了开发和运维环境的差异，使开发和运维可以用相似的语言进行沟通。从系统环境开始，自底至上打包应用。
- 轻量级，对资源的有效隔离和管理。使用docker可以做到进程隔离，资源管理。
- docker可复用，可以通过image被重用，不需要从0开始构建，通过image来交付环境，用tag来指定image的版本，进行版本化。
- docker和持续集成、持续服务、持续部署、微服务等概念相辅相成。



## 架构

![截屏2020-06-21下午4.58.04](https://image-hosting.jellyfishmix.com/20200621165810.png)



