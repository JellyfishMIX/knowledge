# 舱壁模式



## 什么是舱壁模式

舱壁模式（Bulkhead）隔离了每个工作负载或服务的关键资源，如连接池、内存和CPU。
使用舱壁避免了单个工作负载（或服务）消耗掉所有资源，从而导致其他服务出现故障的场景。
这种模式主要是通过防止由一个服务引起的级联故障来增加系统的弹性。

工业中使用舱壁将船舶划分为几个部分，以便在船体破坏的情况下，可以将船舶各个部件密封起来。舱壁的概念在软件开发中可以被应用在隔离资源上。

通过应用舱壁模式，我们可以保护有限的资源不被耗尽。例如，对于一个有连接数限制的数据库实例来说，如果我们有两种连接它的操作，我们采用可以采用两个连接池的方式进行连接，来代替仅采用一个共享连接池的方式。由于这种客户端与资源进行了隔离，超时或过度使用池的操作页不会使其他操作失败。

泰坦尼克号沉没的主要原因之一是其舱壁设计失败，水可以通过上面的甲板倒在舱壁的顶部，导致整个船体淹没。



## 场景说明

让不同任务请求通过自个专门的线程池请求到各自微服务，像舱壁一样对资源进行隔离； 假设这么个场景，在应用中你需要使用REST通过HTTP连接五个不同的微服务，使用一个普通的线程池去维持这些连接，如果五个服务中其中一个服务由于某种原因出现异常，所有的池成员都将精疲力尽的等待服务器响应，为了最大限度地减少的影响，它始终是一个很好的做法，定制个性化服务话服务始终是一个号的做法。这可以减少某个异常影响对其他服务的影响，从而使您的应用程序其他部分继续执行。这种模式俗称的舱壁。
下图描述了实施舱壁的简单的示例场景：在左侧，微服务A，用同一个连接池去请求X和Y两个服务。如果服务X或服务的Y其中任何一个行为异常，这会影响连接池的整体行为。如果舱壁模式实现，如该图所示的右侧，即使微服务X被错误操作，只有池X将受到影响。微服务Y可以继续为应用程序提供服务。

![img](https://image-hosting.jellyfishmix.com/20201003200103.png)



## 引用/参考

[咱们聊聊舱壁模式 - AskHarries - CSDN](https://blog.csdn.net/dot_life/article/details/80823272)

